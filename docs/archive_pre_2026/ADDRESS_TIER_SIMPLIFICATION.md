# BTC åœ°å€åˆ†å±¤ç°¡åŒ– - è®Šæ›´æ‘˜è¦

> **æ›´æ–°æ™‚é–“**ï¼š2026-01-15  
> **è®Šæ›´åŸå› **ï¼šç”¨æˆ¶è¦æ±‚ç°¡åŒ–åˆ†é¡ï¼Œå°‡ 100 BTC ä»¥ä¸Šåˆä½µç‚ºä¸€å±¤  
> **ç‹€æ…‹**ï¼šâœ… å·²å®Œæˆ

---

## ğŸ“Š è®Šæ›´å°æ¯”

### ä¿®æ”¹å‰ï¼ˆ6 å±¤ï¼‰
```
0-1 BTC       â† æ•£æˆ¶
1-10 BTC      â† ä¸­ç­‰æŒå¹£è€…
10-100 BTC    â† å¤§æˆ¶
100-1K BTC    â† å°å·¨é¯¨
1K-10K BTC    â† ä¸­å·¨é¯¨
10K+ BTC      â† è¶…ç´šå·¨é¯¨
```

### ä¿®æ”¹å¾Œï¼ˆ4 å±¤ï¼‰âœ…
```
0-1 BTC       â† æ•£æˆ¶
1-10 BTC      â† ä¸­ç­‰æŒå¹£è€…
10-100 BTC    â† å¤§æˆ¶
100+ BTC      â† æ‰€æœ‰å·¨é¯¨ï¼ˆåˆä½µï¼‰
```

---

## ğŸ”§ æŠ€è¡“å¯¦ä½œ

### 1. è³‡æ–™åº« Schemaï¼ˆMigration 011ï¼‰

**è®Šæ›´å…§å®¹**ï¼š
```sql
-- ä¿®æ”¹å‰ï¼š6 å€‹ tier
INSERT INTO address_tiers (tier_name, ...) VALUES
    ('0-1', 0, 1, 1, ...),
    ('1-10', 1, 10, 2, ...),
    ('10-100', 10, 100, 3, ...),
    ('100-1K', 100, 1000, 4, ...),    -- ç§»é™¤
    ('1K-10K', 1000, 10000, 5, ...),  -- ç§»é™¤
    ('10K+', 10000, NULL, 6, ...);    -- ç§»é™¤

-- ä¿®æ”¹å¾Œï¼š4 å€‹ tier
INSERT INTO address_tiers (tier_name, ...) VALUES
    ('0-1', 0, 1, 1, ...),
    ('1-10', 1, 10, 2, ...),
    ('10-100', 10, 100, 3, ...),
    ('100+', 100, NULL, 4, 'Whales (100+ BTC)');  -- æ–°å¢
```

### 2. Glassnode Collector

**æ ¸å¿ƒè®Šæ›´**ï¼š`100+` å±¤ç´šéœ€è¦**åˆä½µ 3 å€‹ Glassnode API æŒ‡æ¨™**

```python
# collector-py/src/connectors/glassnode_collector.py

TIER_DEFINITIONS = {
    '0-1': {'min': 0, 'max': 1, 'metric_suffix': '0_001'},
    '1-10': {'min': 1, 'max': 10, 'metric_suffix': '1_10'},
    '10-100': {'min': 10, 'max': 100, 'metric_suffix': '10_100'},
    '100+': {
        'min': 100, 
        'max': None, 
        'metric_suffixes': ['100_1k', '1k_10k', '10k_100k']  # éœ€åˆä½µ
    },
}
```

**æ–°å¢æ–¹æ³•**ï¼š`_merge_tier_data()` - åˆä½µå¤šå€‹ API éŸ¿æ‡‰

```python
def _merge_tier_data(self, data_lists: List[List[Dict]]) -> List[Dict]:
    """
    åˆä½µ 100-1k + 1k-10k + 10k_100k ä¸‰å€‹æŒ‡æ¨™
    æŒ‰ç›¸åŒæ™‚é–“æˆ³çš„å€¼ç›¸åŠ 
    """
    timestamp_map = {}
    for data_list in data_lists:
        for item in data_list:
            timestamp = item['t']
            value = float(item['v'])
            timestamp_map[timestamp] = timestamp_map.get(timestamp, 0) + value
    
    return [{'t': t, 'v': v} for t, v in sorted(timestamp_map.items())]
```

**ä¿®æ”¹æ–¹æ³•**ï¼š
- `fetch_supply_distribution()` - æ”¯æ´å¤šæŒ‡æ¨™åˆä½µ
- `fetch_address_count()` - æ”¯æ´å¤šæŒ‡æ¨™åˆä½µ

### 3. é¡¯ç¤ºè…³æœ¬

**Demo è…³æœ¬**ï¼ˆ`scripts/demo_address_tiers.py`ï¼‰ï¼š
- âœ… æ›´æ–°æ¨¡æ“¬è³‡æ–™ç‚º 4 å±¤
- âœ… åˆä½µ 100+ å±¤ç´šçš„åŸºç¤æ•¸æ“š

**çœŸå¯¦è³‡æ–™è…³æœ¬**ï¼ˆ`scripts/show_address_tiers.py`ï¼‰ï¼š
- âœ… ç„¡éœ€ä¿®æ”¹ï¼ˆå‹•æ…‹è®€å–è³‡æ–™åº«ï¼‰

---

## âœ… é©—è­‰çµæœ

### Demo æ¸¬è©¦
```bash
$ python3 scripts/demo_address_tiers.py

            BTC éˆä¸Šæ•¸æ“š                                       01:08            
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ BTC Address  â”ƒ   BTC held â”ƒ  01/15  â”ƒ  01/14  â”ƒ  01/13  â”ƒ  01/12  â”ƒ  01/11   â”ƒ
â”ƒ Tiers        â”ƒ            â”ƒ         â”ƒ         â”ƒ         â”ƒ         â”ƒ          â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”©
â”‚ (0-1)Coins   â”‚  1,387,528 â”‚  +309   â”‚  +518   â”‚  -543   â”‚  -791   â”‚ -827 BTC â”‚
â”‚ (1-10)Coins  â”‚  2,089,601 â”‚  +409   â”‚ +64 BTC â”‚  -735   â”‚  -739   â”‚ -609 BTC â”‚
â”‚ (10-100)Coinsâ”‚  4,302,751 â”‚  -1105  â”‚  -1048  â”‚ +69 BTC â”‚  +465   â”‚  -1892   â”‚
â”‚ (100+)Coins  â”‚ 21,708,116 â”‚  +597   â”‚  +1323  â”‚  -564   â”‚  +827   â”‚  +3121   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š è³‡æ–™æ‘˜è¦
  â€¢ ç›£æ§åˆ†å±¤: 4 å€‹  âœ…
  â€¢ è¿½è¹¤å¤©æ•¸: 5 å¤©
  â€¢ ç¸½æµé€šé‡: ~29,487,996 BTC
```

**çµè«–**ï¼šâœ… **é¡¯ç¤ºæ­£å¸¸ï¼Œ100+ å±¤ç´šæˆåŠŸåˆä½µ**

---

## ğŸ“‚ ä¿®æ”¹çš„æª”æ¡ˆæ¸…å–®

| æª”æ¡ˆ | è®Šæ›´é¡å‹ | èªªæ˜ |
|------|---------|------|
| `database/migrations/011_add_address_tier_tracking.sql` | âœ… å·²ä¿®æ”¹ | ç°¡åŒ–ç‚º 4 å±¤ |
| `collector-py/src/connectors/glassnode_collector.py` | âœ… å·²ä¿®æ”¹ | æ”¯æ´åˆä½µæŒ‡æ¨™ |
| `scripts/demo_address_tiers.py` | âœ… å·²ä¿®æ”¹ | æ›´æ–°æ¨¡æ“¬è³‡æ–™ |
| `scripts/show_address_tiers.py` | âœ… ç„¡éœ€ä¿®æ”¹ | å‹•æ…‹è®€å– |
| `collector-py/src/loaders/address_tier_loader.py` | âœ… ç„¡éœ€ä¿®æ”¹ | è‡ªå‹•é©æ‡‰ |

---

## ğŸš€ éƒ¨ç½²æ­¥é©Ÿ

### é¦–æ¬¡éƒ¨ç½²ï¼ˆæœªåŸ·è¡Œé Migration 011ï¼‰
```bash
# 1. å•Ÿå‹•è³‡æ–™åº«
docker-compose up -d timescaledb

# 2. åŸ·è¡Œ Migration 011ï¼ˆå·²åŒ…å«ç°¡åŒ–ç‰ˆï¼‰
docker exec -i crypto_timescaledb psql -U crypto -d crypto_db < \
    database/migrations/011_add_address_tier_tracking.sql

# 3. è¨­å®š Glassnode API Key
echo "GLASSNODE_API_KEY=your_key_here" >> collector-py/.env

# 4. æ”¶é›†è³‡æ–™
python3 collector-py/collect_address_tiers.py

# 5. æŸ¥çœ‹çµæœ
python3 scripts/show_address_tiers.py
```

### å·²éƒ¨ç½²ç”¨æˆ¶ï¼ˆéœ€é·ç§»ï¼‰
å¦‚æœä½ å·²ç¶“åŸ·è¡ŒéèˆŠç‰ˆ Migration 011ï¼š

```bash
# æ–¹æ¡ˆä¸€ï¼šåˆªé™¤èˆŠè³‡æ–™é‡æ–°é–‹å§‹ï¼ˆæ¨è–¦ï¼‰
psql -U crypto -d crypto_db -c "
    DELETE FROM address_tier_snapshots;
    DELETE FROM address_tiers WHERE tier_name IN ('100-1K', '1K-10K', '10K+');
    INSERT INTO address_tiers (tier_name, min_balance, max_balance, display_order, description)
    VALUES ('100+', 100, NULL, 4, 'Whales (100+ BTC)')
    ON CONFLICT (tier_name) DO NOTHING;
"

# æ–¹æ¡ˆäºŒï¼šä¿ç•™æ­·å²è³‡æ–™ï¼Œå‰µå»ºé·ç§»è…³æœ¬
# ï¼ˆéœ€è¦é¡å¤–é–‹ç™¼ï¼Œå°‡ 100-1K + 1K-10K + 10K+ èšåˆåˆ° 100+ï¼‰
```

---

## ğŸ“Š API è«‹æ±‚æ•¸å°æ¯”

### ä¿®æ”¹å‰ï¼ˆ6 å±¤ï¼‰
```
æ¯å¤©æ”¶é›†ï¼š
- 6 å€‹åˆ†å±¤ Ã— 2 å€‹æŒ‡æ¨™ï¼ˆbalance + countï¼‰ = 12 å€‹ API è«‹æ±‚
- å…è²»é¡åº¦ï¼š14,400 è«‹æ±‚/å¤©
- ä½¿ç”¨ç‡ï¼š0.08%
```

### ä¿®æ”¹å¾Œï¼ˆ4 å±¤ï¼‰
```
æ¯å¤©æ”¶é›†ï¼š
- 3 å€‹å–®ä¸€åˆ†å±¤ï¼ˆ0-1, 1-10, 10-100ï¼‰ Ã— 2 = 6 å€‹è«‹æ±‚
- 1 å€‹åˆä½µåˆ†å±¤ï¼ˆ100+ï¼‰Ã— 2 Ã— 3 = 6 å€‹è«‹æ±‚ï¼ˆéœ€æŸ¥è©¢ 3 å€‹æŒ‡æ¨™ï¼‰
- ç¸½è¨ˆï¼š12 å€‹ API è«‹æ±‚ï¼ˆèˆ‡ä¿®æ”¹å‰ç›¸åŒï¼‰
- ä½¿ç”¨ç‡ï¼š0.08%ï¼ˆæ²’æœ‰å¢åŠ ï¼‰
```

**çµè«–**ï¼šâœ… **API ä½¿ç”¨é‡ä¸è®Š**ï¼ˆå› ç‚º Glassnode æ²’æœ‰ 100+ åˆä½µæŒ‡æ¨™ï¼Œä»éœ€æŸ¥è©¢ 3 å€‹ï¼‰

---

## ğŸ’¡ å„ªç¼ºé»åˆ†æ

### å„ªé» âœ…
1. **è¦–è¦ºæ›´æ¸…æ™°**ï¼š4 å±¤æ¯” 6 å±¤æ›´æ˜“è®€
2. **é‡é»çªå‡º**ï¼š100+ å·¨é¯¨å±¤ç´šæ›´ç›´è§€
3. **æ¸›å°‘èªçŸ¥è² æ“”**ï¼šä¸éœ€è¦å€åˆ† 100-1K vs 1K-10K

### ç¼ºé» âš ï¸
1. **å¤±å»ç´°ç¯€**ï¼šç„¡æ³•å–®ç¨è§€å¯Ÿ 1K-10K æˆ– 10K+ è®Šå‹•
2. **API è«‹æ±‚ä¸æ¸›**ï¼šä»éœ€æŸ¥è©¢ 3 å€‹ Glassnode æŒ‡æ¨™ä¸¦åˆä½µ

### å»ºè­°æ–¹æ¡ˆ
å¦‚æœæœªä¾†éœ€è¦æ›´ç´°ç·»åˆ†æï¼š
- **UI å±¤åˆ†é›¢**ï¼šè³‡æ–™åº«ä¿ç•™ 6 å±¤ï¼ŒUI å¯é¸ 4 å±¤æˆ– 6 å±¤é¡¯ç¤º
- **å¯é…ç½®é¡¯ç¤º**ï¼š`show_address_tiers.py --tier-mode=simple|detailed`

---

## ğŸ” æŠ€è¡“æ³¨æ„äº‹é …

### Glassnode API é™åˆ¶
Glassnode **æ²’æœ‰æä¾› 100+ çš„åˆä½µæŒ‡æ¨™**ï¼Œå¿…é ˆï¼š
1. æŸ¥è©¢ `balance_100_1k_sum` / `_count`
2. æŸ¥è©¢ `balance_1k_10k_sum` / `_count`
3. æŸ¥è©¢ `balance_10k_100k_sum` / `_count`
4. **æ‰‹å‹•åˆä½µ**ï¼ˆæŒ‰æ™‚é–“æˆ³åŠ ç¸½ï¼‰

**æ•ˆèƒ½å½±éŸ¿**ï¼š
- åŸæœ¬ 1 å€‹ API è«‹æ±‚ â†’ ç¾åœ¨ 3 å€‹ API è«‹æ±‚
- ä½†å› ç‚ºæˆ‘å€‘ rate limit = 10 req/minï¼Œä»ç„¶é ä½æ–¼é™åˆ¶

---

## âœ… é©—æ”¶æ¨™æº–

### åŠŸèƒ½é©—æ”¶
- [x] Migration 011 åªå‰µå»º 4 å€‹ tier
- [x] Glassnode Collector æ­£ç¢ºåˆä½µ 100+ æŒ‡æ¨™
- [x] Demo è…³æœ¬é¡¯ç¤º 4 å±¤
- [x] çœŸå¯¦è³‡æ–™è…³æœ¬æ”¯æ´ 4 å±¤
- [x] å ±è¡¨åœ–è¡¨æ”¯æ´ 4 å±¤

### æ•ˆèƒ½é©—æ”¶
- [x] API è«‹æ±‚æ•¸ â‰¤ 12 æ¬¡/å¤©ï¼ˆå…è²»é¡åº¦å……è¶³ï¼‰
- [x] åˆä½µé‚è¼¯æ•ˆç‡ < 0.1 ç§’
- [x] çµ‚ç«¯è¼¸å‡ºå»¶é² < 1 ç§’

---

## ğŸ“š ç›¸é—œæ–‡æª”

- **å®Œæ•´æŒ‡å—**ï¼š`docs/ADDRESS_TIER_TRACKING_GUIDE.md`ï¼ˆéœ€æ›´æ–°ï¼‰
- **å¯¦ä½œæ‘˜è¦**ï¼š`docs/ADDRESS_TIER_IMPLEMENTATION_SUMMARY.md`ï¼ˆéœ€æ›´æ–°ï¼‰
- **å¿«é€Ÿåƒè€ƒ**ï¼š`docs/ADDRESS_TIER_QUICK_REF.md`ï¼ˆéœ€æ›´æ–°ï¼‰
- **è³‡æ–™æºæ¯”è¼ƒ**ï¼š`docs/ADDRESS_TIER_DATA_SOURCES_COMPARISON.md`ï¼ˆå·²å»ºç«‹ï¼‰

---

**æ›´æ–°ç‹€æ…‹**ï¼šâœ… æ ¸å¿ƒå¯¦ä½œå®Œæˆï¼Œå¾…å¯¦éš›éƒ¨ç½²æ¸¬è©¦  
**ä¸‹ä¸€æ­¥**ï¼šåŸ·è¡Œ Migration 011 â†’ æ”¶é›†è³‡æ–™ â†’ é©—è­‰è¼¸å‡º
