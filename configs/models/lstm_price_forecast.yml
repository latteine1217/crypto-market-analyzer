# ============================================
# LSTM 價格預測模型配置
# ============================================

# 實驗基本資訊
experiment:
  name: lstm_btc_price_forecast
  version: "v1.0"
  description: "使用 LSTM 預測 BTC 未來 1 小時價格走勢"
  random_seed: 42

# 資料配置
data:
  source:
    exchange: binance
    symbol: BTCUSDT
    timeframe: 1m
    start_date: "2024-01-01T00:00:00Z"
    end_date: "2024-12-31T23:59:59Z"

  # 資料清洗版本
  cleaning_version: "v1"

  # 訓練/驗證/測試 切分
  split:
    train: 0.7
    validation: 0.15
    test: 0.15
    method: sequential  # sequential, random

# 特徵工程
features:
  # 價格特徵
  price:
    - returns_1m      # 1分鐘報酬率
    - returns_5m      # 5分鐘報酬率
    - returns_15m     # 15分鐘報酬率
    - returns_60m     # 60分鐘報酬率

  # 移動平均
  moving_average:
    - ma_5
    - ma_10
    - ma_20
    - ma_60

  # 波動度
  volatility:
    - std_5
    - std_20
    - std_60

  # 成交量
  volume:
    - volume_ma_5
    - volume_ma_20
    - volume_ratio    # 當前成交量 / 平均成交量

  # 技術指標
  technical:
    - rsi_14
    - macd
    - bollinger_bands

  # 時間特徵
  temporal:
    - hour_of_day
    - day_of_week
    - is_weekend

# 目標變數
target:
  name: price_change_60m
  type: regression
  horizon: 60  # 預測未來 60 分鐘的價格變化
  calculation: (close_t+60 - close_t) / close_t

# 模型架構
model:
  type: lstm
  architecture:
    sequence_length: 60  # 使用過去 60 個時間步
    lstm_layers:
      - units: 128
        return_sequences: true
        dropout: 0.2
      - units: 64
        return_sequences: true
        dropout: 0.2
      - units: 32
        return_sequences: false
        dropout: 0.2
    dense_layers:
      - units: 16
        activation: relu
        dropout: 0.1
      - units: 1
        activation: linear

  # 編譯配置
  compile:
    optimizer:
      type: adam
      learning_rate: 0.001
    loss: mse
    metrics:
      - mae
      - mape

# 訓練配置
training:
  batch_size: 32
  epochs: 100
  validation_split: 0.15
  early_stopping:
    enabled: true
    monitor: val_loss
    patience: 10
    min_delta: 0.0001
  reduce_lr:
    enabled: true
    monitor: val_loss
    factor: 0.5
    patience: 5
    min_lr: 0.00001

# 評估指標
evaluation:
  metrics:
    - mse
    - mae
    - mape
    - r2_score
    - directional_accuracy  # 方向預測準確率

# 輸出配置
output:
  model_path: models/saved/lstm_btc_v1.h5
  predictions_path: results/lstm_btc_v1/predictions.csv
  metrics_path: results/lstm_btc_v1/metrics.json
  plots:
    - actual_vs_predicted
    - residuals
    - feature_importance
