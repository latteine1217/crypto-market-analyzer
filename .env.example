# ============================================
# Crypto Market Dashboard - Environment Variables
# ============================================
# 使用方式：複製此檔案為 .env 並填入實際值
# 注意：生產環境請修改所有預設密碼！

# ===== 系統配置 =====
ENVIRONMENT=development
TZ=Asia/Taipei

# ===== TimescaleDB 配置 =====
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=crypto
POSTGRES_PASSWORD=crypto_pass
POSTGRES_DB=crypto_db

# Docker 內部使用時，POSTGRES_HOST=db
# 本機開發使用時，POSTGRES_HOST=localhost

# ===== Redis 配置 =====
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Docker 內部使用時，REDIS_HOST=redis
# 本機開發使用時，REDIS_HOST=localhost

# ===== API Keys（交易所） =====
# Binance API (公開數據不需要)
BINANCE_API_KEY=
BINANCE_API_SECRET=

# Coinbase API
COINBASE_API_KEY=
COINBASE_API_SECRET=

# Bybit API
BYBIT_API_KEY=
BYBIT_API_SECRET=

# OKX API
OKX_API_KEY=
OKX_API_SECRET=
OKX_PASSPHRASE=

# ===== 區塊鏈 API 配置 =====
# Glassnode API (BTC 鏈上數據 - 地址分層追蹤)
# 獲取方式：https://studio.glassnode.com/settings/api
GLASSNODE_API_KEY=

# Etherscan API (Ethereum 主網)
# 獲取方式：https://etherscan.io/myapikey
ETHERSCAN_API_KEY=

# BscScan API (Binance Smart Chain)
# 獲取方式：https://bscscan.com/myapikey
BSCSCAN_API_KEY=

# TronScan API (Tron 主網)
# 獲取方式：https://tronscan.org/#/login
TRONSCAN_API_KEY=

# Blockchain.com API (Bitcoin)
# 公開 API 不需要 key
BLOCKCHAIN_API_KEY=

# ===== Collector 配置 =====
COLLECTOR_INTERVAL_SECONDS=60
DEFAULT_TIMEFRAME=1m
DEFAULT_LIMIT=1000

# ===== WebSocket Collector 配置 =====
WS_SYMBOLS=BTCUSDT,ETHUSDT
WS_STREAMS=trade,depth
WS_RECONNECT=true
WS_RECONNECT_DELAY=5000
WS_HEARTBEAT_INTERVAL=30000
WS_MAX_RECONNECT_ATTEMPTS=10

# ===== Flush 配置 =====
FLUSH_BATCH_SIZE=100
FLUSH_INTERVAL_MS=5000
FLUSH_MAX_RETRIES=3

# ===== 日誌配置 =====
LOG_LEVEL=INFO
LOG_DIR=logs
LOG_JSON=true
LOG_ROTATION=500 MB
LOG_RETENTION=30 days
LOG_MAX_SIZE=500m
LOG_MAX_FILES=30d

# ===== Dashboard 配置 =====
DASHBOARD_PORT=8050
DASHBOARD_DEBUG=false

# ===== Monitoring 配置 =====
# Prometheus
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# Alertmanager
ALERTMANAGER_PORT=9093

# Telegram Bot（用於告警通知）
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# ===== 其他配置 =====
# 資料品質閾值
QUALITY_THRESHOLD=80


# ============================================
# 資料保留策略監控配置
# ============================================

# 監控服務配置
RETENTION_MONITOR_METRICS_PORT=8003
RETENTION_CHECK_INTERVAL_MINUTES=30

# 告警閾值配置
RETENTION_DEVIATION_WARNING_PERCENT=20  # 偏差超過 20% 發出警告
RETENTION_DEVIATION_CRITICAL_PERCENT=50  # 偏差超過 50% 發出嚴重警告

AGGREGATE_STALE_HOURS=2  # 聚合視圖超過 N 小時未更新視為異常
JOB_NOT_RUNNING_HOURS=2  # Job 超過 N 小時未執行視為異常

# 資料完整性檢查
CHECK_COMPRESSION_RATIO=true  # 是否檢查壓縮比
EXPECTED_5M_RATIO=5.0  # 1m vs 5m 預期壓縮比
COMPRESSION_RATIO_TOLERANCE=1.5  # 壓縮比容忍偏差
